---
import Layout from "../layouts/Layout.astro";
import OffreCard from "../components/OffreCard.astro";
// Images
import { getOffres } from "../../js/backend.mjs";


const offres = await getOffres();
---
<Layout titre="Offres">
  <h1 class="text-3xl font-bold text-blue-800 mb-6">
    Nos offres
  </h1>

  <!-- Bouton favoris (JS plus bas) -->
  <button
    id="favori-button"
    class="mb-8 rounded-full px-6 py-3 bg-blue-800 text-blue-100 hover:bg-blue-900 transition"
  >
    Afficher les favoris
  </button>

 <!-- Grille des offres -->
<div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
  {
    offres.map((offre) => (
      <OffreCard
        {...offre}
        image={`http://127.0.0.1:8090/api/files/maison/${offre.id}/${offre.imgUrl?.[0]}`}
      />
    ))
  }
</div>

<!-- InteractivitÃ© favoris -->
<script>
  const button = document.getElementById("favori-button");
  let showOnlyFavorites = false;

  button?.addEventListener("click", () => {
    showOnlyFavorites = !showOnlyFavorites;

    document.querySelectorAll(".offre").forEach((card) => {
      const isFavori = card.getAttribute("data-favori") === "true";

      if (showOnlyFavorites) {
        card.style.display = isFavori ? "block" : "none";
        button.textContent = "Afficher tout";
      } else {
        card.style.display = "block";
        button.textContent = "Afficher les favoris";
      }
    });
  });
</script>
